apiVersion: azuredevops.kog.krateo.io/v1alpha1
kind: GitRepository
metadata:
  name: test-gitrepository-kog
  namespace: adp
  annotations:
    krateo.io/connector-verbose: "true"
spec:
  authenticationRefs:
    basicAuthRef: azure-devops-basic-auth         # Reference to a CR containing the basic authentication information.
  api-version: "7.2-preview.2"                    # Version of the API to use

  organization: "krateo-kog"                      # name of the Azure DevOps organization
  projectId: "test-project-1-classic"             # ID or name of the project

  name: "test-gitrepository-kog-v3"               # Name of the repository to create or manage  

  # UPDATE ONLY FIELD: currently not supported
  #defaultBranch: "refs/heads/main2"              # Default branch for the repository

  # Fork-related fields: these fields are needed if the repository to be created is a fork of another repository
  project: 
    id: abf8b734-b13c-4acf-a8b2-d2267f3adae2      # ID of the project where the repository will be created

  parentRepository:
    id: "2c8d9074-7522-4c9b-8d70-c962712d7fe8"    # ID of the parent repository to fork
    project:
      id: "abf8b734-b13c-4acf-a8b2-d2267f3adae2"  # ID of the parent repository's project

  #sourceRef: "refs/heads/main" wrong encoding (sourceRef=refs%252Fheads%252Fmain)
  # needs to be fixed on RDC?
  #sourceRef: "test-branch" just branch name does not work
  #refs/heads/test-branch with a manual curl works, so the fact that is encoded is the problem
  # omitting sourceRef to use default branch of the parent repository works





